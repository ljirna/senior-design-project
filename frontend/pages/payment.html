<main class="page-container">
  <div class="payment-page">
    <div class="container">
      <h1 class="section-title">Complete Your Payment</h1>

      <div class="payment-container">
        <!-- Payment Methods -->
        <div class="payment-form-section">
          <h2 class="section-title">Checkout</h2>

          <div class="payment-methods">
            <div class="payment-method selected" data-method="card">
              <div class="payment-method-icon">
                <i class="far fa-credit-card"></i>
              </div>
              <div class="payment-method-info">
                <div class="payment-method-name">Credit or Debit Card</div>
                <div class="payment-method-desc">
                  Pay with Visa, MasterCard, or American Express
                </div>
              </div>
              <div class="payment-method-check">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>
          </div>

          <!-- Credit Card Form -->
          <div class="payment-form active" id="card-form">
            <div class="card-icons">
              <i class="fab fa-cc-visa"></i>
              <i class="fab fa-cc-mastercard"></i>
              <i class="fab fa-cc-amex"></i>
              <i class="far fa-credit-card"></i>
            </div>

            <form id="payment-form">
              <div class="form-group">
                <label for="card-number" class="form-label">Card Number</label>
                <div class="input-with-icon">
                  <input
                    type="text"
                    id="card-number"
                    class="form-control"
                    placeholder="1234 5678 9012 3456"
                    maxlength="19"
                    required
                  />
                  <i class="fas fa-credit-card input-icon"></i>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="expiry-date" class="form-label"
                    >Expiry Date</label
                  >
                  <input
                    type="text"
                    id="expiry-date"
                    class="form-control"
                    placeholder="MM/YY"
                    maxlength="5"
                    required
                  />
                </div>

                <div class="form-group">
                  <label for="cvv" class="form-label">CVV</label>
                  <div class="input-with-icon">
                    <input
                      type="text"
                      id="cvv"
                      class="form-control"
                      placeholder="123"
                      maxlength="4"
                      required
                    />
                    <i class="fas fa-lock input-icon"></i>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="cardholder-name" class="form-label"
                  >Cardholder Name</label
                >
                <input
                  type="text"
                  id="cardholder-name"
                  class="form-control"
                  placeholder="John Doe"
                  required
                />
              </div>

              <div class="save-card-checkbox">
                <input type="checkbox" id="save-card" />
                <label for="save-card"
                  >Save this card for future purchases</label
                >
              </div>
            </form>

            <div class="security-badge">
              <i class="fas fa-shield-alt"></i>
              <span
                >Your payment information is secured with 256-bit SSL
                encryption</span
              >
            </div>
          </div>

          <!-- Payment Actions -->
          <div class="payment-actions">
            <button class="btn-back" id="back-to-cart">
              <i class="fas fa-arrow-left"></i> Back to Cart
            </button>
            <button class="btn-pay" id="pay-now">
              <i class="fas fa-lock"></i> Complete Payment
            </button>
          </div>
        </div>

        <!-- Order Summary -->
        <div class="order-summary-section">
          <h2 class="section-title">Order Summary</h2>

          <div class="order-items">
            <div class="order-item">
              <span class="order-item-name">Modern Leather Sofa × 1</span>
              <span class="order-item-price">$1,299.99</span>
            </div>
            <div class="order-item">
              <span class="order-item-name">Glass Coffee Table × 1</span>
              <span class="order-item-price">$299.99</span>
            </div>
            <div class="order-item">
              <span class="order-item-name">Leather Lounge Chair × 2</span>
              <span class="order-item-price">$999.98</span>
            </div>
          </div>

          <div class="summary-totals">
            <div class="summary-row">
              <span>Subtotal</span><span>$2,799.95</span>
            </div>
            <div class="summary-row">
              <span>Shipping</span><span>$49.99</span>
            </div>
            <div class="summary-row"><span>Tax</span><span>$199.99</span></div>
            <div class="summary-row total">
              <span>Total</span><span>$3,049.93</span>
            </div>
          </div>

          <div class="delivery-info">
            <h3 class="delivery-title">
              <i class="fas fa-truck"></i> Delivery Information
            </h3>
            <div class="delivery-address">
              <strong>John Smith</strong><br />
              123 Main Street<br />
              New York, NY 10001<br />
              <i class="fas fa-phone"></i> (123) 456-7890
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Success Modal (Will be shown/hidden by JS) -->
<div class="modal-overlay" id="success-modal" style="display: none">
  <div class="success-modal">
    <div class="success-icon"><i class="fas fa-check"></i></div>

    <h2>Payment Successful!</h2>
    <p>Your order has been confirmed and will be shipped soon.</p>

    <div class="order-details">
      <div><span>Order Number:</span> <strong>#ZM-2024-78945</strong></div>
      <div><span>Total:</span> <strong>$3,049.93</strong></div>
      <div><span>Payment:</span> <strong>Credit Card</strong></div>
    </div>

    <button class="btn-view-order" id="view-order-details">
      <i class="fas fa-receipt"></i> View Order Details
    </button>
    <button class="btn-close-modal" id="continue-shopping">
      <i class="fas fa-shopping-bag"></i> Continue Shopping
    </button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    console.log("Payment page loaded");

    // Format card number input
    const cardNumberInput = document.getElementById("card-number");
    if (cardNumberInput) {
      cardNumberInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        let formattedValue = "";
        for (let i = 0; i < value.length; i++) {
          if (i > 0 && i % 4 === 0) {
            formattedValue += " ";
          }
          formattedValue += value[i];
        }
        e.target.value = formattedValue.substring(0, 19);
      });
    }

    // Format expiry date input
    const expiryInput = document.getElementById("expiry-date");
    if (expiryInput) {
      expiryInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length >= 2) {
          value = value.substring(0, 2) + "/" + value.substring(2);
        }
        e.target.value = value.substring(0, 5);
      });
    }

    // Back to cart button
    const backToCartBtn = document.getElementById("back-to-cart");
    if (backToCartBtn) {
      backToCartBtn.addEventListener("click", function () {
        window.location.hash = "cart";
      });
    }

    // Pay now button
    const payNowBtn = document.getElementById("pay-now");
    if (payNowBtn) {
      payNowBtn.addEventListener("click", function () {
        const cardNumber = document.getElementById("card-number").value;
        const expiry = document.getElementById("expiry-date").value;
        const cvv = document.getElementById("cvv").value;
        const name = document.getElementById("cardholder-name").value;

        if (!cardNumber || !expiry || !cvv || !name) {
          if (typeof showToast === "function") {
            showToast("Please fill in all payment details", "error");
          } else {
            alert("Please fill in all payment details");
          }
          return;
        }

        // Simulate payment processing
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        this.disabled = true;

        setTimeout(() => {
          // Show success modal
          const modal = document.getElementById("success-modal");
          if (modal) {
            modal.style.display = "flex";
          }

          // Reset button
          this.innerHTML = '<i class="fas fa-lock"></i> Complete Payment';
          this.disabled = false;
        }, 2000);
      });
    }

    // Modal buttons
    const continueShoppingBtn = document.getElementById("continue-shopping");
    if (continueShoppingBtn) {
      continueShoppingBtn.addEventListener("click", function () {
        const modal = document.getElementById("success-modal");
        if (modal) {
          modal.style.display = "none";
        }
        window.location.hash = "home";
      });
    }

    const viewOrderBtn = document.getElementById("view-order-details");
    if (viewOrderBtn) {
      viewOrderBtn.addEventListener("click", function () {
        if (typeof showToast === "function") {
          showToast("Order details will be available in your profile", "info");
        } else {
          alert("Order details will be available in your profile");
        }
      });
    }
  });
</script>
